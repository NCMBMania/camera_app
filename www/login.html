<ons-page>
  <ons-toolbar>
    <div class="center" id="form-title">新規登録/ログイン</div>
  </ons-toolbar>
  <div style="text-align: center; margin-top: 60px;"></div>
    <p style="text-align: center;">
      <ons-input id="userName" modifier="underbar" placeholder="ユーザ名" float></ons-input>
    </p>
    <p style="text-align: center;">
      <ons-input id="password" modifier="underbar" type="password" placeholder="パスワード" float></ons-input>
    </p>
    <p style="margin-top: 30px;text-align: center;">
      <ons-button id="login">登録/ログイン</ons-button>
    </p>
  </div>

  <script>
    async function signInOrLogin() {
      // 必要な変数を揃えます
      const userName = this.querySelector('#userName').value;
      const password = this.querySelector('#password').value;
      try {
        // ユーザ登録処理を実行
        // すでに同名でユーザ登録済みの場合、エラーになります
        await registerUser(userName, password);
      } catch (e) {
        // すでに同名でユーザ登録済みの場合、こちらにきます（エラーは無視します）
      }
      try {
        // ログイン実行

        // カメラ画面に戻ります
        document.querySelector('#nav').resetToPage('camera.html');
      } catch (e) {
        // ログイン失敗した場合
        ons.notification.alert('ログイン失敗しました。ユーザ名、パスワードを確認してください');
        return false;
      }
    }

    ons.getScriptPage().onInit = function() {
      this.querySelector('#login').onclick = signInOrLogin.bind(this);
    }

    // 新規ユーザ登録処理です
    async function registerUser(userName, password) {
    }
  </script>
</ons-page>
